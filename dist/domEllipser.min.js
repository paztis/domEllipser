/*!
 * @license domEllipser v1.0.0
 * https://github.com/paztis/domEllipser
 * 
 * Copyright (c) 2017 Jerome HENAFF <jerome.henaff@gmail.com>
 * Licensed under the MIT license
 */
!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.DomEllipser=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var DomEllipser=function(){function DomEllipser(){this.isAlreadyProcessed=function(domE){return!!this._getWrapperElement(domE)}}
//--------------------------
// Wrapper
//--------------------------
//--------------------------
// Config
//--------------------------
//--------------------------
// Results
//--------------------------
//--------------------------
// Overflow Position search
//--------------------------
/**
     * Show/hide the ellipsis element.
     *
     * @param config
     * @param show
     */
return DomEllipser.prototype.isAlreadyEllipsed=function(domE){return!!domE.querySelector("["+DomEllipser.DATA_ATTRIBUTES.ellipsis+"]")},DomEllipser.prototype.getOriginalContent=function(domE){var originalE=domE.querySelector("["+DomEllipser.DATA_ATTRIBUTES.original+"]");return originalE?originalE.innerHTML:null},DomEllipser.prototype.ellipse=function(domE,options){if(void 0===options&&(options={}),domE){var wrapperE=this._getWrapperElement(domE);wrapperE||(wrapperE=this._wrapElement(domE));var config=this._getExistingConfig(domE,wrapperE,options),previousResults=config?config.results:null,maxHeight=options.maxHeight||domE.clientHeight,isOverflow=this._isTextOverflow(domE,maxHeight),isNowEllipsed=!1;
// Content overflows
// Do something only if previous config
// Try to put the original content
return isOverflow?previousResults?(config.maxHeight=maxHeight,this._processEllipsis(config,0,previousResults.cropIndex)):(config=config||this._generateConfig(domE,wrapperE,options),config.maxHeight=maxHeight,this._processEllipsis(config,0,config.originalText.length),isNowEllipsed=!0):config&&(config.croppedE.innerHTML=config.originalE.innerHTML,config.maxHeight=options.maxHeight||domE.clientHeight,this._isTextOverflow(domE,config.maxHeight)&&(previousResults?this._processEllipsis(config,previousResults.cropIndex,config.originalText.length):this._processEllipsis(config,0,config.originalText.length),isNowEllipsed=!0)),config&&this._displayEllipsis(config,isNowEllipsed),isNowEllipsed}},DomEllipser.prototype._processEllipsis=function(config,startIndex,endIndex){var nodeToCrop,originalContent;this._hasChildElements(config.croppedE)?(nodeToCrop=this._getOverflowChildNode(config),originalContent=nodeToCrop.textContent,startIndex=0,endIndex=originalContent.length):(nodeToCrop=config.croppedE,originalContent=config.originalText);var cropIndex=this._getOverflowPosition(config,startIndex,endIndex,originalContent,nodeToCrop),croppedText=nodeToCrop.textContent.substring(0,cropIndex);nodeToCrop.textContent=croppedText,nodeToCrop===config.wrapperE&&this._storeCurrentResults(config.wrapperE,{cropIndex:cropIndex})},DomEllipser.prototype._getWrapperElement=function(domE){var children=domE.children;return 1===children.length&&children[0].hasAttribute(DomEllipser.DATA_ATTRIBUTES.wrapper)?children[0]:null},DomEllipser.prototype._wrapElement=function(domE){var wrapperE=document.createElement("div");wrapperE.setAttribute(DomEllipser.DATA_ATTRIBUTES.wrapper,"true"),wrapperE.setAttribute("style","word-break: break-word; white-space: normal; overflow: hidden");for(var child=domE.firstChild;child;child=domE.firstChild)child.parentNode.removeChild(child),wrapperE.appendChild(child);return domE.appendChild(wrapperE),wrapperE},DomEllipser.prototype._getExistingConfig=function(domE,wrapperE,options){var originalE=wrapperE.querySelector("["+DomEllipser.DATA_ATTRIBUTES.original+"]");if(originalE){var croppedE=wrapperE.querySelector("["+DomEllipser.DATA_ATTRIBUTES.cropped+"]"),ellipsisE=wrapperE.querySelector("["+DomEllipser.DATA_ATTRIBUTES.ellipsis+"]");return{options:options,results:this._getCurrentResults(wrapperE),originalText:originalE.textContent,domE:domE,wrapperE:wrapperE,originalE:originalE,croppedE:croppedE,ellipsisE:ellipsisE}}return null},DomEllipser.prototype._generateConfig=function(domE,wrapperE,options){var hasChildElements=this._hasChildElements(wrapperE),originalText=hasChildElements?wrapperE.innerHTML:wrapperE.textContent,fragment=document.createDocumentFragment(),originalE=document.createElement("span");originalE.setAttribute(DomEllipser.DATA_ATTRIBUTES.original,"true"),originalE.style.display="none",fragment.appendChild(originalE);var croppedE=document.createElement("span");croppedE.setAttribute(DomEllipser.DATA_ATTRIBUTES.cropped,"true"),fragment.appendChild(croppedE);var ellipsisE=document.createElement("span");ellipsisE.setAttribute(DomEllipser.DATA_ATTRIBUTES.ellipsis,"true"),options.ellipsisHTML?ellipsisE.innerHTML=options.ellipsisHTML:ellipsisE.textContent=options.ellipsis||"â€¦",fragment.appendChild(ellipsisE);for(var child=wrapperE.firstChild;child;child=wrapperE.firstChild)if(child.parentNode.removeChild(child),!this._isConfigElement(child)){var cropChild=child.cloneNode(!0);originalE.appendChild(child),croppedE.appendChild(cropChild)}return wrapperE.appendChild(fragment),{options:options,results:null,originalText:originalText,domE:domE,wrapperE:wrapperE,originalE:originalE,croppedE:croppedE,ellipsisE:ellipsisE}},DomEllipser.prototype._getCurrentResults=function(wrapperE){var textResults=wrapperE.getAttribute(DomEllipser.DATA_ATTRIBUTES.cache);return textResults?JSON.parse(textResults):null},DomEllipser.prototype._storeCurrentResults=function(wrapperE,results){wrapperE.setAttribute(DomEllipser.DATA_ATTRIBUTES.cache,JSON.stringify(results))},DomEllipser.prototype._getOverflowPosition=function(config,startIndex,endIndex,originalText,node){for(var startPosition=startIndex,endPosition=endIndex,middlePosition=-1;startPosition<endPosition;){var m=Math.floor((startPosition+endPosition)/2);if(m==middlePosition)break;middlePosition=m,this._testTextOverflow(config,node,originalText.substring(0,middlePosition))?startPosition=middlePosition:endPosition=middlePosition}return middlePosition},DomEllipser.prototype._getOverflowChildNode=function(config){for(var lastRemovedChild,lastChild=config.croppedE.lastChild;lastChild&&this._isTextOverflow(config.domE,config.maxHeight);)lastChild.parentNode.removeChild(lastChild),lastRemovedChild=lastChild,lastChild=config.croppedE.lastChild;return lastRemovedChild&&config.croppedE.appendChild(lastRemovedChild),config.croppedE.lastChild},DomEllipser.prototype._isTextOverflow=function(domE,maxHeight){return domE.scrollHeight>maxHeight},DomEllipser.prototype._testTextOverflow=function(config,node,textContent){return node.textContent=textContent,!this._isTextOverflow(config.domE,config.maxHeight)},DomEllipser.prototype._hasChildElements=function(domE){for(var childNode=domE.firstChild;childNode;childNode=childNode.nextSibling)if(1===childNode.nodeType&&!this._isConfigElement(childNode))return!0},DomEllipser.prototype._isConfigElement=function(node){if(1===node.nodeType){var elt=node;for(var key in DomEllipser.DATA_ATTRIBUTES)if(elt.hasAttribute(DomEllipser.DATA_ATTRIBUTES[key]))return!0}return!1},DomEllipser.prototype._displayEllipsis=function(config,show){config&&(show?config.ellipsisE.removeAttribute("style"):config.ellipsisE.setAttribute("style","display: none"))},DomEllipser}();DomEllipser.DATA_ATTRIBUTES={wrapper:"data-wrapper",original:"data-original",cropped:"data-cropped",ellipsis:"data-ellipsis",cache:"data-cache"};var ellipserInstance=new DomEllipser;module.exports=ellipserInstance},{}]},{},[1])(1)});